### My Approach: Finding Suspicious User Activity

My goal was to find users who might be engaging in suspicious activities, specifically by having their **click locations not match their signup locations**.

* First, I **loaded all the necessary transaction data, user signup data, and click location data** into my analysis environment. I did this using `pd.read_csv()` for each file because that's how you bring data into pandas.
* I suspected that **country codes might be inconsistent** (some IDs, some two-letter codes), so I fetched a **country mapping file** from a URL using `requests.get()` and then created conversion dictionaries (`id_to_code` and `code_to_name`). This let me consistently translate all country IDs and codes into proper country names.
* I needed to **know where each user signed up and where each click actually occurred**. So, I merged the `clicks` data with `clicks_country` data by `click_id` using `pd.merge()`, and then merged that result with `user_signup_location` data by `adv_id` using `pd.merge()`. This combined all the relevant location information for every click into one place.
* I suspected that **some users might have different signup and click locations**. To check this, I created a new column called `is_discrepancy` by simply comparing `signup_country_code` and `click_country_code` for each click. If they were different, it was flagged as `True`.
* I wanted to see **how many discrepancies there were overall**. I did this by filtering my main data frame to just the rows where `is_discrepancy` was `True`, and then I used `len()` to count them. This gave me the total number and percentage of clicks with location mismatches.
* I suspected that **certain country "routes" might be popular for discrepancies**. So, I used `groupby()` on `signup_country_name` and `click_country_name`, and then `size()` to count the occurrences of each unique pair. This showed me the top locations involved in mismatches.
* I also suspected that **some individual users might be generating many discrepancies**. To find them, I used `groupby()` on `adv_id` within the discrepancy data and `size()` to count how many discrepancies each user had. This identified the top users with suspicious location jumps.
* I needed to understand if **users with high discrepancies were also very active**. I calculated the `total_clicks` for each user and then the `discrepant_clicks`. I then looked for "hyperactive" users who had many total clicks *and* a very high percentage of those clicks were discrepant. I used simple filtering based on a threshold (`> 100` total clicks and `> 0.8` discrepancy rate) for this.
* I suspected that **users might be actively "hopping" between multiple countries**. I used `groupby('adv_id')` and `nunique()` on `click_country_code` to count how many unique countries each user clicked from. This helped me find users active across several locations, which is often a red flag.
* Finally, to get an **overall picture of fraud risk for each user**, I created a **simple fraud score**. I built a custom function (`simple_fraud_score`) that assigned points based on things like their discrepancy rate, the number of unique click countries, their total click volume, and reward diversity. This function helped me combine all the red flags into a single score.
* Based on this score, I **classified each user into a risk level** (e.g., 'CRITICAL', 'HIGH', 'MEDIUM') using another custom function (`classify_risk`). This provided clear categories for further action.
* To summarize my findings, I printed out the **distribution of users across these risk levels** using `value_counts()` and listed the **top suspicious users** by sorting on their `fraud_score` using `sort_values()`.

This streamlined approach allowed me to quickly pinpoint potential fraud patterns and high-risk users by combining and analyzing different data points related to user location and activity.
